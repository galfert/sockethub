!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ActivityStreams=t()}}(function(){return function t(e,r,n){function i(s,c){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(o)return o(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var a=r[s]={exports:{}};e[s][0].call(a.exports,function(t){var r=e[s][1][t];return i(r?r:t)},a,a.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){function n(t,e){for(var r=Object.keys(e),n=r.length-1;n>=0;n-=1)if(f[t].indexOf(r[n])<0)if(l[r[n]])e[l[r[n]]]=e[r[n]],delete e[r[n]];else{if(e["@type"]&&"object"==typeof a[e["@type"]]&&a[e["@type"]].indexOf(r[n])>=0)continue;if(u.indexOf(e["@type"])<0)return"invalid property "+r[n]}return!1}var i=t("event-emitter"),o=t("array-keys"),s=new o({identifier:"@id"}),c=i(),u=[],f={stream:["@type","actor","target","object","@context"],object:["@id","@type","@context","alias","attachedTo","attachment","attributedTo","attributedWith","content","context","contextOf","displayName","endTime","generator","generatorOf","icon","image","inReplyTo","memberOf","location","locationOf","objectOf","originOf","preview","previewOf","provider","providerOf","published","rating","resultOf","replies","scope","scopeOf","startTime","summary","tag","tagOf","targetOf","title","updated","url"]},a={},l={id:"@id",verb:"@type",objectType:"@type",platform:"@context"},p={actor:{primary:"@id",props:f},target:{primary:"@id",props:f},object:{primary:"content",props:f}},h=Object.keys(p),d=function(t){var e={},r=n("stream",t);if(r)throw new Error(r);if("object"==typeof t.object&&(r=n("object",t.object)))throw new Error(r);for(var i in t)if("string"==typeof t[i])e[i]=s.getRecord(t[i])||t[i];else if(Array.isArray(t[i]))for(e[i]=[],o=t[i].length-1;o>=0;o-=1)"string"==typeof t[i][o]&&(e[i][o]=s.getRecord(t[i][o])||t[i][o]);else e[i]=t[i];for(var o=h.length-1;o>=0;o-=1)if("string"==typeof e[h[o]]){var u=p[h[o]].primary,f={};f[u]=e[h[o]],e[h[o]]=f}return c.emit("activity-stream",e),e},m={create:function(t){var e=!1,r=n("object",t);if(r)throw new Error(r);try{e=s.addRecord(t)}catch(i){throw new Error(i)}return e&&c.emit("activity-object-create",t),e},"delete":function(t){var e=s.removeRecord(t);return e&&c.emit("activity-object-delete",t),e},get:function(t){var e=s.getRecord(t);return e?e:t},list:function(){return s.getIdentifiers()},getByType:function(t){s.forEach(function(t){})}};e.exports=function(t){if("object"==typeof t&&(u=t.specialObjs||[],"object"==typeof t.customProps))for(var e=Object.keys(t.customProps),r=0,n=e.length;n>r;r+=1)if("object"==typeof t.customProps[e[r]]){a[e[r]]=[];for(var i=0,o=t.customProps[e[r]].length;o>i;i+=1)a[e[r]].push(t.customProps[e[r]][i])}return{Stream:d,Object:m,on:function(t,e){return c.on(t,e)},once:function(t,e){return c.once(t,e)},off:function(t,e){return c.off(t,e)}}}},{"array-keys":2,"event-emitter":4}],2:[function(t,e,r){function n(t){"object"!=typeof t&&(t={}),this._identifier=t.identifier||"id",this._store=[],this._idx=[],t.emitEvents?(this._emitEvents=!0,this.events=new i):this._emitEvents=!1}var i=t("tiny-emitter");n.prototype.emitEvent=function(t,e,r){this._emitEvents&&!r&&this.events.emit(t,e)},n.prototype.getIdentifiers=function(){for(var t=[],e=this._store.length-1;e>=0;e-=1)t[t.length]=this._store[e][this._identifier];return t},n.prototype.getRecord=function(t){for(var e=this._store.length-1;e>=0;e-=1)if(this._store[e][this._identifier]===t)return this._store[e];return void 0},n.prototype.exists=function(t){return this.getIndex(t)>=0?!0:!1},n.prototype.getIndex=function(t){for(var e=this._idx.length-1;e>=0;e-=1)if(this._idx[e]===t)return e;return-1},n.prototype.addRecord=function(t){if("object"!=typeof t)throw new Error("cannot add non-object records.");if(!t[this._identifier])throw new Error("cannot add a record with no `"+this._identifier+"` property specified.");var e=this.removeRecord(t[this._identifier],!0);return this._idx[this._idx.length]=t[this._identifier],this._store[this._store.length]=t,setTimeout(function(){e?setTimeout(this.emitEvent.bind(this,"update",t),0):setTimeout(this.emitEvent.bind(this,"add",t),0)}.bind(this),0),!0},n.prototype.removeRecord=function(t,e){var r=this.getIndex(t);if(0>r)return!1;for(var n=r;n>=0;n-=1)if(this._store[n][this._identifier]===t)return this._store.splice(n,1),this._idx.splice(r,1),setTimeout(this.emitEvent.bind(this,"remove",t,e),0),!0;for(var i=this._store.length-1;i!==r;i-=1)if(this._store[i][this._identifier]===t)return this._store.splice(i,1),this._idx.splice(r,1),setTimeout(this.emitEvent.bind(this,"remove",t,e),0),!0;return!1},n.prototype.forEachRecord=function(t){var e=0,r=this,n=function(){};return setTimeout(function(){for(var i=r._store.length-1;i>=0;i-=1)e+=1,setTimeout(t(r._store[i]),0);setTimeout(n(e),0)},0),{"finally":function(t){n=t}}},n.prototype.getCount=function(){return this._store.length},e.exports=n},{"tiny-emitter":3}],3:[function(t,e,r){function n(){}n.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this,i=function(){n.off(t,i),e.apply(r,arguments)};return this.on(t,i,r)},emit:function(t){var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=r.length;for(n;i>n;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],i=[];if(n&&e)for(var o=0,s=n.length;s>o;o++)n[o].fn!==e&&i.push(n[o]);return i.length?r[t]=i:delete r[t],this}},e.exports=n},{}],4:[function(t,e,r){"use strict";var n,i,o,s,c,u,f,a=t("d"),l=t("es5-ext/object/valid-callable"),p=Function.prototype.apply,h=Function.prototype.call,d=Object.create,m=Object.defineProperty,y=Object.defineProperties,v=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};n=function(t,e){var r;return l(e),v.call(this,"__ee__")?r=this.__ee__:(r=g.value=d(null),m(this,"__ee__",g),g.value=null),r[t]?"object"==typeof r[t]?r[t].push(e):r[t]=[r[t],e]:r[t]=e,this},i=function(t,e){var r,i;return l(e),i=this,n.call(this,t,r=function(){o.call(i,t,r),p.call(e,this,arguments)}),r.__eeOnceListener__=e,this},o=function(t,e){var r,n,i,o;if(l(e),!v.call(this,"__ee__"))return this;if(r=this.__ee__,!r[t])return this;if(n=r[t],"object"==typeof n)for(o=0;i=n[o];++o)(i===e||i.__eeOnceListener__===e)&&(2===n.length?r[t]=n[o?0:1]:n.splice(o,1));else(n===e||n.__eeOnceListener__===e)&&delete r[t];return this},s=function(t){var e,r,n,i,o;if(v.call(this,"__ee__")&&(i=this.__ee__[t]))if("object"==typeof i){for(r=arguments.length,o=new Array(r-1),e=1;r>e;++e)o[e-1]=arguments[e];for(i=i.slice(),e=0;n=i[e];++e)p.call(n,this,o)}else switch(arguments.length){case 1:h.call(i,this);break;case 2:h.call(i,this,arguments[1]);break;case 3:h.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),e=1;r>e;++e)o[e-1]=arguments[e];p.call(i,this,o)}},c={on:n,once:i,off:o,emit:s},u={on:a(n),once:a(i),off:a(o),emit:a(s)},f=y({},u),e.exports=r=function(t){return null==t?d(f):y(Object(t),u)},r.methods=c},{d:5,"es5-ext/object/valid-callable":14}],5:[function(t,e,r){"use strict";var n,i=t("es5-ext/object/assign"),o=t("es5-ext/object/normalize-options"),s=t("es5-ext/object/is-callable"),c=t("es5-ext/string/#/contains");n=e.exports=function(t,e){var r,n,s,u,f;return arguments.length<2||"string"!=typeof t?(u=e,e=t,t=null):u=arguments[2],null==t?(r=s=!0,n=!1):(r=c.call(t,"c"),n=c.call(t,"e"),s=c.call(t,"w")),f={value:e,configurable:r,enumerable:n,writable:s},u?i(o(u),f):f},n.gs=function(t,e,r){var n,u,f,a;return"string"!=typeof t?(f=r,r=e,e=t,t=null):f=arguments[3],null==e?e=void 0:s(e)?null==r?r=void 0:s(r)||(f=r,r=void 0):(f=e,e=r=void 0),null==t?(n=!0,u=!1):(n=c.call(t,"c"),u=c.call(t,"e")),a={get:e,set:r,configurable:n,enumerable:u},f?i(o(f),a):a}},{"es5-ext/object/assign":6,"es5-ext/object/is-callable":9,"es5-ext/object/normalize-options":13,"es5-ext/string/#/contains":16}],6:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Object.assign:t("./shim")},{"./is-implemented":7,"./shim":8}],7:[function(t,e,r){"use strict";e.exports=function(){var t,e=Object.assign;return"function"!=typeof e?!1:(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],8:[function(t,e,r){"use strict";var n=t("../keys"),i=t("../valid-value"),o=Math.max;e.exports=function(t,e){var r,s,c,u=o(arguments.length,2);for(t=Object(i(t)),c=function(n){try{t[n]=e[n]}catch(i){r||(r=i)}},s=1;u>s;++s)e=arguments[s],n(e).forEach(c);if(void 0!==r)throw r;return t}},{"../keys":10,"../valid-value":15}],9:[function(t,e,r){"use strict";e.exports=function(t){return"function"==typeof t}},{}],10:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?Object.keys:t("./shim")},{"./is-implemented":11,"./shim":12}],11:[function(t,e,r){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],12:[function(t,e,r){"use strict";var n=Object.keys;e.exports=function(t){return n(null==t?t:Object(t))}},{}],13:[function(t,e,r){"use strict";var n=Array.prototype.forEach,i=Object.create,o=function(t,e){var r;for(r in t)e[r]=t[r]};e.exports=function(t){var e=i(null);return n.call(arguments,function(t){null!=t&&o(Object(t),e)}),e}},{}],14:[function(t,e,r){"use strict";e.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},{}],15:[function(t,e,r){"use strict";e.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t}},{}],16:[function(t,e,r){"use strict";e.exports=t("./is-implemented")()?String.prototype.contains:t("./shim")},{"./is-implemented":17,"./shim":18}],17:[function(t,e,r){"use strict";var n="razdwatrzy";e.exports=function(){return"function"!=typeof n.contains?!1:n.contains("dwa")===!0&&n.contains("foo")===!1}},{}],18:[function(t,e,r){"use strict";var n=String.prototype.indexOf;e.exports=function(t){return n.call(this,t,arguments[1])>-1}},{}]},{},[1])(1)});